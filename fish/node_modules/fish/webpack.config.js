let path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const ExtractTextWebpackPlugin = require("extract-text-webpack-plugin");
const CopyWebpackPlugin = require('copy-webpack-plugin');

module.exports = {
    entry:"./src/index.js",
    output:{
        path:path.resolve(__dirname,"dist"),
        publicPath:'/',
        filename:"js/[name].js"
    },
    module:{
        rules:[
            {test:/\.css$/,
                use:ExtractTextWebpackPlugin.extract({
                use:'css-loader'
            })
        },
            {test:/\.js$/,exclude:/node_modules/,use:[{
                loader:"babel-loader",
                options:{
                    presets:['es2015']
                }
            }]}
        ]
    },
    mode:'development',
    devServer: {
        port: 8080,
        open:true
    },
    resolve:{
		extensions: [ '.js', '.css', '.json', '.vue'] 
    },
    plugins:[
        new HtmlWebpackPlugin({
            template:'./index.html',
            filename:'./index.html',
            hash:true,
            minify:{
                removeAttributeQuotes:true
            }
        }),
        new ExtractTextWebpackPlugin('css/[name][hash:6].css'),
        new CopyWebpackPlugin([
            { from: path.resolve(__dirname,'src/static'), to: path.resolve(__dirname,'dist/static') }
          ])
    ],
    // optimization: {
    //     splitChunks: {
    //       cacheGroups: {
    //         cm: {
    //           test: /common/,
    //           chunks: 'initial',
    //           name: 'vendor/common',
    //           priority: 10
    //         }
    //       }
    //     }
    //   }
}